import pandas as pd

# Load all CSVs into pandas DataFrames
abilities = pd.read_csv('data/abilities.csv')
abilities_descriptions = pd.read_csv('data/abilities_descriptions.csv')
abilities_to_work_activities = pd.read_csv('data/abilities_to_work_activities.csv')
work_activities = pd.read_csv('data/work_activities.csv')
skills = pd.read_csv('data/skills.csv')
occupation_data = pd.read_csv('data/occupation_data.csv')
work_context_categories = pd.read_csv('data/work_context_categories.csv')

# Merging the data
abilities_with_descriptions = pd.merge(abilities, abilities_descriptions, on='Abilities Element ID', how='inner')
abilities_with_activities = pd.merge(abilities_with_descriptions, abilities_to_work_activities, on='Abilities Element ID', how='inner')
abilities_with_work_activities = pd.merge(abilities_with_activities, work_activities, on='Work Activities Element ID', how='inner')

# Example of merging occupation data with skills
occupation_with_skills = pd.merge(occupation_data, skills, on='O*NET-SOC Code', how='inner')

# Merging work context data
abilities_with_work_context_categories = pd.merge(abilities_with_work_activities, work_context_categories, on='Work Context Element ID', how='inner')

# Create a JSON file for use in JavaScript
merged_data = abilities_with_work_context_categories.to_json(orient='records')
with open('merged_data.json', 'w') as f:
    f.write(merged_data)

print("Data successfully merged and exported as JSON!")
